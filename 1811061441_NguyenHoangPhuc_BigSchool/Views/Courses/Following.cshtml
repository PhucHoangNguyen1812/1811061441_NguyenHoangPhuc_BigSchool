@model IEnumerable<_1811061441_NguyenHoangPhuc_BigSchool.Models.ApplicationUser>
@{
    ViewBag.Title = "Following";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Following</h2>


<ul>
    @foreach (var viewModel in @Model)
    {
    <li>

        @*<div class="date">
            <div class="month">
                @course.DateTime.ToString("MM")
            </div>
            <div class="day">
                @course.DateTime.ToString("dd")
            </div>
        </div>*@

        @*<div class="details">*@

        <!--<span class="lecturer">-->
            @*@course.Lecturer.Name
            @if (Model.ShowAction)
            {
                <button class="btn btn-info btn-sm js-toggle-follow" data-user-id="@viewModel.Id">
                    Following
                </button>
            }*@
        <!--</span>-->
        <span style="font-weight:bold">@viewModel.Name</span>
        <button class="btn btn-info btn-sm js-toggle-follow" data-user-id="@viewModel.Id">
            Following
        </button>
        <br />
        @*<span class="category">
                @course.Category.Name
            </span>
            @if (Model.ShowAction)
            {
                var User_ID = User.Identity.GetUserId();
                ApplicationDbContext _dbContext = new ApplicationDbContext();
                bool go = _dbContext.Attendances.Any(a => a.CourseId == course.Id && a.AttendeeId == User_ID);
                if (go)
                {
                    <button data-course-id="@course.Id" class="btn btn-info btn-sm js-toggle-attendance">Going</button>
                }
                else
                {
                    <button data-course-id="@course.Id" class="btn btn-default btn-sm js-toggle-attendance">Going?</button>
                }

            }
        </div>*@
    </li>
     }
</ul>

@section scripts
{
    <script>
        $(document).ready(function () {
            //$(".js-toggle-attendance").click(function (e) {
            //    var button = $(e.target);
            //    $.post("/api/attendances", { courseId: button.attr("data-course-id") })
            //        .done(function () {
            //            button
            //                .removeClass("btn-default")
            //                .addClass("btn-info")
            //                .text("Going");
            //        })
            //        .fail(function () {
            //            alert("Something failed!");
            //        });
            //});

            $(".js-toggle-follow").click(function (e) {
                var button = $(e.target);
                if (button.hasClass("btn-default")) {
                    $.post("/api/followings", { followeeId: button.attr("data-user-id") })
                        .done(function () {

                            button
                                .removeClass("btn-default")
                                .addClass("btn-info")
                                .text("Following");
                        })
                        .fail(function () {
                            alert("Something failed!");
                        });
                } else {

                }
            });

        });
    </script>
}

